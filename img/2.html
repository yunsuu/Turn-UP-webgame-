
<script src="../../../Desktop/소설기12.10%20(5)/소설기12.10/anime-master/anime-master/lib/anime.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<div id="anime-login">

    <div class="layout">
        <div class="line" onclick="location.href='AniLogin.html'">
            <span style="
            color:#a1d99b; 
            font-style:silom;
            font-weight: bold;  
            font-size: 10em;
            line-height: 1.0em;
            font-family: arial;           
            ";>Turn</span>

            <span style="
            color:#998ec3;
            font-style:silom;
            font-weight: bold;  
            font-size: 10em;
            line-height: 1.0em;  
            font-family: arial;
            ";>up!</span>
        </div>
        <div class="line"id="makemulti33"style="display: inline-block;" >
            <div class="square " id="_1_1" name='1' style="background-color: #998ec3;"ondrop="drop(event)" ondragover="allowDrop(event)">
                <img id="drag25" name='10' src="../../../Desktop/소설기12.10%20(5)/소설기12.10/stone.png" draggable="true" ondragstart="drag(event)">
            </div>

            <div class="square" id="_1_2" name='0' ondrop="drop(event)" ondragover="allowDrop(event)">
            </div>

            <div class="square" id="_1_3" name='0' ondrop="drop(event)" ondragover="allowDrop(event)">
                    
            </div>
        
        <div class="line">
            <div class="square" id="_2_1" name='0'ondrop="drop(event)" ondragover="allowDrop(event)">
                    
              
            </div>
            <div class="square" id="_2_2" name='0'ondrop="drop(event)" ondragover="allowDrop(event)">
                
                
            </div>
            <div class="square" id="_2_3" name='0'ondrop="drop(event)" ondragover="allowDrop(event)">
                   
                   
            </div>
        </div>
        <div class="line">
            <div class="square" id="_3_1" name='0'ondrop="drop(event)" ondragover="allowDrop(event)">
                    
                
            </div>
            <div class="square" id="_3_2" name='0'ondrop="drop(event)" ondragover="allowDrop(event)">
                    
          
            </div>
            <div class="square "id="_3_3" name='0'ondrop="drop(event)" ondragover="allowDrop(event)">
                    

            </div>
        </div>
    </div>
        <button class="clear" id="clearbtn"onclick="location.href='3.html'" style="font-size:30px;display: none;" >next</button>
         
    </div>
</div>
    <style>
        button {
            background: #a1d99b;
            color: white;
            margin: 20px;
            padding: 40px;
            border-radius: 4px;
            font-family: 'Lato';
            cursor: pointer;
            border: none;
            outline: none;
            transition: all ease 0.1s;
        }

        button:hover {

            background: #998ec3;
            transform: scale( 1.3);
        }

        body {
            margin: 0px;
            font-family: 'Lato';
            font-weight: 300;
            text-align: center;
            font-size: 1.2em;
            background:white;
        }
        .square {
            position: relative;
            width: 100px;
            height: 100px;
            background-color:#a1d99b;
            display: inline-block;
            border: 4px;
            border-radius: 20%;
            cursor: pointer;
            transform-origin: center;
            transition:width 80ms, height 80ms;
        }
        .controls {
            margin-top: 0px;
        }
        .square img{
            position: absolute; top:20; left: 21;
            width: 70%;
            height: 70%;
        }
        .IDPW{

            position: absolute; 
            width: 80px;
        }
    </style>

    <script>
        
        //받아온 값이 빈값인지 아닌지 판단해주는 함수
        function isEmpty(str) {

            if (typeof str == "undefined" || str == null || str == "")
                return true;
            else
                return false;
        }

        var size=3;
        var jgcolor;
        var a33 =
        [
            [0,0,0,0,0],
            [0,0,0,0,0],
            [0,0,0,0,0],
            [0,0,0,0,0],
            [0,0,0,0,0]
        ];
        

        function reverseAni(i, j) {

            var reversecolors = anime.timeline({
                easing: 'easeOutExpo',
                direction: '750',
                autoplay: false
            })
            console.log(size)
            if(size==3){

                a33 =
                [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,0,0,0]
                ];
                //아무것도 없을떄
                if($(`#_${i}_${j}`).attr('name')==0)
                {
                    //위
                    var up=$(`#_${i-1}_${j}`).attr('name');
                    if(up==0||up==2||up==3)
                    {
                        a33[i-1][j]=1;
                    }
                    else if(up==1)
                    {
                        a33[i-1][j]=0;
                    }
                    //좌
                    var left=$(`#_${i}_${j-1}`).attr('name');
                    if(left==0||left==2||left==3)
                    {
                        a33[i][j-1]=1;
                    }
                    else if(left==1)
                    {
                        a33[i][j-1]=0;
                    }
                    //우
                    var right=$(`#_${i}_${j+1}`).attr('name');
                    if(right==0||right==2||right==3)
                    {
                        a33[i][j+1]=1;
                    }
                    else if(right==1)
                    {
                        a33[i][j+1]=0;
                    }
                    //아래
                    var down=$(`#_${i+1}_${j}`).attr('name');
                    if(down==0||down==2||down==3)
                    {
                        a33[i+1][j]=1;
                    }
                    else if(down==1)
                    {
                        a33[i+1][j]=0;
                    }
                    //본인
                    a33[i][j]=1;

                }

                //stone
                if($(`#_${i}_${j}`).attr('name')==1)
                {
                    //상
                    var up=$(`#_${i-1}_${j}`).attr('name');
                    if(up==0||up==2||up==3)
                    {
                        a33[i-1][j]=1;
                    }
                    else if(up==1)
                    {
                        a33[i-1][j]=0;
                    }
                    //좌
                    var left=$(`#_${i}_${j-1}`).attr('name');
                    if(left==0||left==2||left==3)
                    {
                        a33[i][j-1]=1;
                    }
                    else if(left==1)
                    {
                        a33[i][j-1]=0;
                    }
                    //우
                    var right=$(`#_${i}_${j+1}`).attr('name');
                    if(right==0||right==2||right==3)
                    {
                        a33[i][j+1]=1;
                    }
                    else if(right==1)
                    {
                        a33[i][j+1]=0;
                    }
                    //하
                    var down=$(`#_${i+1}_${j}`).attr('name');
                    if(down==0||down==2||down==3)
                    {
                        a33[i+1][j]=1;
                    }
                    else if(down==1)
                    {
                        a33[i+1][j]=0;
                    }
                    //본인
                    a33[i][j]=0;

                }

                //gun
                if($(`#_${i}_${j}`).attr('name')==2)
                {
                    //본인
                    a33[i][j]=1;
                }

                //bomb
                if($(`#_${i}_${j}`).attr('name')==3)
                {
                    //폭탄 터지면 스퀘어 네임값 삭제
                    $(`#_${i}_${j}`).attr(`name`,0);

                    //폭탄 터졌을때 폭탄 이미지 제거
                    $(`#_${i}_${j}`).empty();

                    for(n=i-1;n<i+2;n++)
                    {
                        for(m=j-1;m<j+2;m++)
                        {
                            var s=$(`#_${n}_${m}`).attr('name');
                            if(s==0||s==2)
                            {
                                a33[n][m]=1;
                            }
                            else if(s==1)
                            {
                                a33[n][m]=0;
                            }
                            else if(s==3)
                            {
                                //폭탄 터지면 스퀘어 네임값 삭제
                                $(`#_${n}_${m}`).attr(`name`,0);

                                //폭탄 터졌을때 폭탄 이미지 제거
                                $(`#_${n}_${m}`).empty();

                                for(r=n-1;r<n+2;r++)
                                {
                                    for(t=m-1;t<m+2;t++)
                                    {
                                        var q=$(`#_${r}_${t}`).attr('name');
                                        if(q==0||q==2)
                                        {
                                            a33[r][t]=1
                                        }
                                        else if(q==1)
                                        {
                                            a33[r][t]=0;
                                        }

                                    }

                                }                                            
                            }
                        }
                    }
                }

                console.log(a33)

                for (var h = 1; h < size + 1; h++) {
                for (var w = 1; w < size + 1; w++) {
                    if (a33[h][w] == 1) {
                        console.log('이프문 ',h, w)
                        var firstbgcolor = $(`#_${h}_${w}`).css('backgroundColor');
                        console.log(firstbgcolor)
                        if (firstbgcolor == "rgb(161, 217, 155)") {
                            reversecolor = "#998ec3";
                            console.log(h%1)
                        } 
                        else if (firstbgcolor == "rgb(153, 142, 195)") {
                            reversecolor = "#a1d99b";
                            console.log(h*100)
                        }
                        console.log(`원래색깔 : ${firstbgcolor}, 바뀐색깔 : ${reversecolor}`)
                        $(`#_${h}_${w}`).css('backgroundColor',reversecolor)

                    }

                }
            }
        }
        }

    
    //블록 클릭했을때 애니메이션
        $('.square').click(function() {
            var a = $(this).attr('id');
            var click_i = parseInt(a[1]);
            var click_j = parseInt(a[3]);
            reverseAni(click_i,click_j);
            var i=0;
            for (var h = 1; h <4; h++) {
                    for (var w = 1; w < 4; w++) {
                        var firstbgcolor = $(`#_${h}_${w}`).css('backgroundColor')
                        if(firstbgcolor == "rgb(153, 142, 195)")
                        {
                            i++;
                        }
                        else
                        {
                            i=0;
                        }
                    }
            }
            if(i==9)
            {
                document.getElementById("clearbtn").style.display = 'inline-block';
            }
        });

        //버튼동작 모음

        $('.savemap').click(function() {
            location.href="choosetype.html";
        });

        var i=1;
        for (var h = 1; h <4; h++) {
                for (var w = 1; w < 4; w++) {
                    var firstbgcolor = $(`#_${h}_${w}`).css('backgroundColor')
                    if(firstbgcolor == "rgb(153, 142, 195)")
                    i++;
                }
        }

                    



    </script>